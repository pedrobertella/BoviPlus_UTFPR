CREATE TABLE RACA (
ID_RACA INT NOT NULL,
NOME VARCHAR(45) NOT NULL,
TEMPO_GESTACAO INT NOT NULL,
DESCRICAO VARCHAR(140) NOT NULL,
CONSTRAINT PK_RACA PRIMARY KEY(ID_RACA)
);

CREATE TABLE TIPO (
ID_TIPO INT NOT NULL,
NOME VARCHAR(30) NOT NULL,
DESCRICAO VARCHAR(45) NOT NULL,
CONSTRAINT PK_TIPO PRIMARY KEY(ID_TIPO)
);

CREATE TABLE LOTE(
ID_LOTE INT DEFAULT 0 PRIMARY KEY NOT NULL,
NOME_LOTE VARCHAR(30) DEFAULT 'Indefinido'
);

CREATE TABLE ANIMAL (
ID_ANIMAL INT NOT NULL,
NOME VARCHAR(20),
NASCIMENTO DATE,
PESO DECIMAL(7,3),
DESCRICAO VARCHAR(300) NOT NULL,
CONSTRAINT PK_ANIMAL PRIMARY KEY(ID_ANIMAL),
ID_MAE INT,
ID_PAI INT,
ID_TIPO INT,
ID_RACA INT,
LACTACAO BOOLEAN DEFAULT FALSE NULL,
ID_LOTE int,
CONSTRAINT FK_ANIMAL_MAE FOREIGN KEY (ID_MAE) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ANIMAL_PAI FOREIGN KEY (ID_PAI) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ANIMAL_TIPO FOREIGN KEY (ID_TIPO) REFERENCES TIPO(ID_TIPO) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ANIMAL_RACA FOREIGN KEY (ID_RACA) REFERENCES RACA(ID_RACA) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ANIMAL_LOTE FOREIGN KEY (ID_LOTE) REFERENCES LOTE (ID_LOTE) ON UPDATE CASCADE ON DELETE NO ACTION
);

CREATE TABLE VENDA_ANIMAL (
ID_VENDA INT NOT NULL,
ID_ANIMAL INT NOT NULL,
VALOR DECIMAL(9,2) NOT NULL,
DATA_VENDA DATE NOT NULL,
CONSTRAINT FK_VENDA_ANIMAL_ANIMAL FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_VENDA_ANIMAL PRIMARY KEY(ID_VENDA)
);

CREATE TABLE contas_receber
(
  id_contas_receber SERIAL,
  QTD NUMERIC (9,3),
  VALOR NUMERIC (9,2),
  data_vencimento date not null,
  data_recebimento date,
  descricao varchar(150),
  producao boolean default false,
  PRIMARY KEY (id_contas_receber)
 );

CREATE TABLE ENTREGA_LEITE (
ID_ENTREGA INT NOT NULL,
QTD DECIMAL(10,3) NOT NULL,
INICIO DATE NOT NULL,
FIM DATE NOT NULL,
VALOR_LITRO DECIMAL(3,2) NOT NULL,
ID_CONTA INTEGER,
CONSTRAINT PK_ENTREGA_LEITE PRIMARY KEY(ID_ENTREGA),
FOREIGN KEY(ID_CONTA) REFERENCES CONTAS_RECEBER(ID_CONTAS_RECEBER) ON UPDATE CASCADE ON DELETE SET NULL
);

CREATE TABLE PRODUCAO (
ID_VACA INT NOT NULL,
DATA_PRODUCAO DATE NOT NULL,
LITRAGEM DECIMAL(6,3) NOT NULL,
CONSTRAINT FK_PRODUCAO_VACA FOREIGN KEY (ID_VACA) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_PRODUCAO primary key(ID_VACA, DATA_PRODUCAO)
);

CREATE TABLE DOENCA (
ID_DOENCA INT NOT NULL,
NOME VARCHAR(45) NOT NULL,
DESCRICAO VARCHAR(200) NOT NULL,
CONSTRAINT PK_DOENCA PRIMARY KEY(ID_DOENCA)
);

CREATE TABLE ENFERMIDADE (
ID_ANIMAL INT NOT NULL,
ID_DOENCA INT NOT NULL,
TEMPO_CARENCIA INT NOT NULL,
TEMPO_TRATAMENTO INT NOT NULL,
DATA_ENFERMIDADE DATE NOT NULL,
CONSTRAINT FK_ENFERMIDADE_ANIMAL FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ENFERMIDADE_DOENCA FOREIGN KEY (ID_DOENCA) REFERENCES DOENCA(ID_DOENCA) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_ENFERMIDADE PRIMARY KEY(DATA_ENFERMIDADE, ID_ANIMAL, ID_DOENCA)
);

CREATE TABLE VACINA (
ID_VACINA INT NOT NULL,
NOME VARCHAR(25) NOT NULL,
INDICACAO VARCHAR(90) NOT NULL,
CONTRA_INDC VARCHAR(90) NOT NULL,
PERIODICA BOOLEAN DEFAULT FALSE NOT NULL,
CAMPANHA VARCHAR(50) NULL,
MES VARCHAR(10) NULL,
CAT_ANIMAIS VARCHAR(30) NULL,
CONSTRAINT PK_VACINA PRIMARY KEY(ID_VACINA)
);

CREATE TABLE MEDICAMENTO (
       	ID_MED INT NOT NULL,
      	NOME VARCHAR(25) NOT NULL,
   	INDICACAO VARCHAR(100) NOT NULL,
	CONTRA_INDC VARCHAR(100) NOT NULL,
	CONSTRAINT PK_MEDICAMENTO PRIMARY KEY(ID_MED)
);

CREATE TABLE VACINACAO (
id_vacinacao integer not null,
ID_ANIMAL INT NOT NULL,
ID_VACINA INT NOT NULL,
DOSE DECIMAL(5,2) NOT NULL,
DATA_VACINACAO DATE NOT NULL,
MOTIVO VARCHAR(45) NOT NULL,
CONSTRAINT FK_VACINACAO_ANIMAL FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_VACINACAO_VACINA FOREIGN KEY (ID_VACINA) REFERENCES VACINA(ID_VACINA) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_VACINACAO PRIMARY KEY(ID_ANIMAL, ID_VACINA, DATA_VACINACAO)
);

CREATE TABLE REPRODUCAO (
ID_GESTACAO INT NOT NULL,
ID_MAE INT NOT NULL,
ID_PAI INT NOT NULL,
PREVISAO DATE NOT NULL,
DATA_INSEMINACAO DATE NOT NULL,
CONSTRAINT FK_REPRODUCAO_ANIMAL_MAE FOREIGN KEY (ID_MAE) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_REPRODUCAO_ANIMAL_PAI FOREIGN KEY (ID_PAI) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_REPRODUCAO PRIMARY KEY(ID_GESTACAO)
);

CREATE TABLE TIPO_ALIMENTO (
ID_TIPO_ALIMENTO INT NOT NULL,
NOME VARCHAR(30) NOT NULL,
DESCRICAO VARCHAR(45) NOT NULL,
CONSTRAINT PK_TIPO_ALIMENTO PRIMARY KEY(ID_TIPO_ALIMENTO)
);

CREATE TABLE UNIDADE_MEDIDA (
ID_UNDMDD INT NOT NULL,
NOME VARCHAR(30) NOT NULL,
DESCRICAO VARCHAR(45) NOT NULL,
CONSTRAINT PK_UNDMDD PRIMARY KEY(ID_UNDMDD)
);

CREATE TABLE ALIMENTO (
ID_ALIMENTO INT NOT NULL,
NOME VARCHAR(15) NOT NULL,
CONSTRAINT PK_ALIMENTO PRIMARY KEY(ID_ALIMENTO),
ID_TIPO_ALIMENTO INT,
ID_UNDMDD INT,
CONSTRAINT FK_ALIMENTO_TIPO FOREIGN KEY (ID_TIPO_ALIMENTO) REFERENCES TIPO_ALIMENTO(ID_TIPO_ALIMENTO) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ALIMENTO_UNDMDD FOREIGN KEY (ID_UNDMDD) REFERENCES UNIDADE_MEDIDA(ID_UNDMDD) ON UPDATE CASCADE ON DELETE NO ACTION
);

CREATE TABLE ESTOQUE (

	ID_MOVIMENTO INTEGER NOT NULL,
	ID_ALIMENTO INTEGER NOT NULL,
	QUANT NUMERIC(13,3) NOT NULL,
	VALOR_UNI NUMERIC (12,2) NOT NULL,
	DATA_COMPRA DATE NOT NULL,
	PRIMARY KEY (ID_MOVIMENTO),
	FOREIGN KEY (ID_ALIMENTO) REFERENCES ALIMENTO(ID_ALIMENTO) ON UPDATE CASCADE ON DELETE CASCADE

);


CREATE TABLE GASTO_DIARIO (
	ID_ALIMENTO INTEGER NOT NULL,
	VALOR NUMERIC(12,2),
	DIA DATE,
	PRIMARY KEY(ID_ALIMENTO, DIA),
	FOREIGN KEY (ID_ALIMENTO) REFERENCES alimento(ID_ALIMENTO)
);

CREATE TABLE ALIMENTACAO (
ID_ALIMENTO INT NOT NULL,
ID_ANIMAL INT NOT NULL,
QTD DECIMAL(6,3) NOT NULL,
DATA_ALIMENTACAO DATE NOT NULL,
CONSTRAINT FK_ALIMENTACAO_ALIMENTO FOREIGN KEY (ID_ALIMENTO) REFERENCES ALIMENTO(ID_ALIMENTO) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_ALIMENTACAO_ANIMAL FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_ALIMENTACAO PRIMARY KEY(ID_ANIMAL, ID_ALIMENTO, DATA_ALIMENTACAO)
);

CREATE TABLE CONTAS_PAGAR (
ID_CONTAS_PAGAR INT NOT NULL,
VALOR DECIMAL(10,2) NOT NULL,
DATA_PAGAMENTO DATE NULL,
DATA_VENCIMENTO DATE NOT NULL,
ORIGEM INT,
CONSTRAINT PK_CONTAS_PAGAR PRIMARY KEY(ID_CONTAS_PAGAR)
);

CREATE TABLE EQUIPAMENTO (
ID_EQUIPAMENTO INT NOT NULL,
NOME VARCHAR(25) NOT NULL,
DESCRICAO VARCHAR(45) NOT NULL,
QTD INT NOT NULL,
CONSTRAINT PK_EQUIPAMENTO PRIMARY KEY(ID_EQUIPAMENTO)
);

CREATE TABLE CUSTO_EQUIPAMENTO (
ID_EQUIPAMENTO INT NOT NULL,
ID_CONTAS_PAGAR INT NOT NULL,
QTD INT NOT NULL,
VALOR DECIMAL(9,2) NOT NULL,
CONSTRAINT FK_CUSTO_EQUIPAMENTO_EQUIPAMENTO FOREIGN KEY (ID_EQUIPAMENTO) REFERENCES EQUIPAMENTO(ID_EQUIPAMENTO) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_CUSTO_EQUIPAMENTO_CONTAS_PAGAR FOREIGN KEY (ID_CONTAS_PAGAR) REFERENCES CONTAS_PAGAR(ID_CONTAS_PAGAR) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_CUSTO_EQUIPAMENTO PRIMARY KEY(ID_EQUIPAMENTO, ID_CONTAS_PAGAR)
);

CREATE TABLE custo_vacina (
    id_vacina integer,
    id_contas_pagar integer REFERENCES contas_pagar(id_contas_pagar) ON UPDATE CASCADE,
    qtd integer NOT NULL,
    valor numeric(9,2) NOT NULL,
    CONSTRAINT pk_custo_vacina PRIMARY KEY (id_vacina, id_contas_pagar)
);

CREATE TABLE CUSTO_REPRODUCAO (
ID_GESTACAO INT NOT NULL,
ID_CONTAS_PAGAR INT NOT NULL,
QTD INT  NOT NULL,
VALOR DECIMAL(9,2) NOT NULL,
CONSTRAINT FK_CUSTO_REPRODUCAO_CONTAS_PAGAR FOREIGN KEY (ID_CONTAS_PAGAR) REFERENCES CONTAS_PAGAR(ID_CONTAS_PAGAR) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT FK_CUSTO_REPRODUCAO_GESTACAO FOREIGN KEY (ID_GESTACAO) REFERENCES REPRODUCAO(ID_GESTACAO) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_CUSTO_REPRODUCAO PRIMARY KEY(ID_GESTACAO, ID_CONTAS_PAGAR)
);

CREATE TABLE EXAME (
ID_EXAME INT NOT NULL,
NOME VARCHAR(45) NOT NULL,
DESCRICAO VARCHAR(300) NOT NULL,
DATA_EXAME DATE NOT NULL,
CATEGORIA CHAR NOT NULL,
INTERVALO INT NOT NULL,
CONSTRAINT PK_EXAME PRIMARY KEY(ID_EXAME),
ID_ANIMAL INT,
CONSTRAINT FK_EXAME_ANIMAL FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE NO ACTION
);

CREATE TABLE CUSTO_ALIMENTO (
ID_ALIMENTO INT NOT NULL,
ID_CONTAS_PAGAR INT NOT NULL,
QTD DECIMAL(10,3) NOT NULL,
VALOR DECIMAL(9,2) NOT NULL,
CONSTRAINT FK_CUSTO_ALIMENTO_CONTAS_PAGAR FOREIGN KEY (ID_CONTAS_PAGAR) REFERENCES CONTAS_PAGAR(ID_CONTAS_PAGAR) ON UPDATE CASCADE ON DELETE NO ACTION,
CONSTRAINT PK_CUSTO_ALIMENTO PRIMARY KEY(ID_ALIMENTO, ID_CONTAS_PAGAR)
);


CREATE TABLE USUARIO(
ID_USER SERIAL NOT NULL,
NOME VARCHAR(30) NOT NULL,
SENHA VARCHAR(30) NOT NULL,
PERMISSOES CHAR(7) DEFAULT '0000000',
CONSTRAINT PK_USUARIO PRIMARY KEY(ID_USER)
);

CREATE TABLE ORDEM_PRODUCAO
(
    ID_ORDEM SERIAL PRIMARY KEY NOT NULL,
    ID_ANIMAL INT NOT NULL,
    CONSTRAINT ORDEM_PRODUCAO_ANIMAL_FK FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL (ID_ANIMAL) ON DELETE CASCADE ON UPDATE CASCADE
);
-- alter sequence ordem_producao_id_ordem_seq restart with 1;

CREATE TABLE LACTACAO(
	ID_ANIMAL INT PRIMARY KEY,
	DATA_LAC DATE NOT NULL,
	FLAG BOOLEAN NOT NULL,
	FOREIGN KEY (ID_ANIMAL) REFERENCES ANIMAL(ID_ANIMAL) ON UPDATE CASCADE ON DELETE CASCADE
);

CREATE TABLE PREFSIS(

	ID INT PRIMARY KEY,
	AVISO_SECAGEM INT,
	AVISO_NASCIMENTO INT,
	ATALHO1 VARCHAR(50),
	ATALHO2 VARCHAR(50),
	ATALHO3 VARCHAR(50),
	ATALHO4 VARCHAR(50),
	ATALHO5 VARCHAR(50),
	CRECEBER integer,
    	CPAGAR integer,
	AVISO_VACINA integer,
	AVISO_EXAME integer,
	MUDO boolean,
	AUTOALIMENTACAO boolean,
	PREVESTOQUE integer
	
);

CREATE TABLE CUSTO_GERAL(
	ID_GERAL SERIAL,
	ID_CONTAS_PAGAR INTEGER,
	QTD INTEGER,
	VALOR NUMERIC(9,2),
	DESCRICAO VARCHAR(150),
	PRIMARY KEY (ID_GERAL),
	FOREIGN KEY (ID_CONTAS_PAGAR) REFERENCES CONTAS_PAGAR(ID_CONTAS_PAGAR) ON UPDATE CASCADE ON DELETE CASCADE
);

create table produtor(
	nome varchar(100) not null,
	cpf varchar(11) not null,
	nasc date not null,
	fazenda varchar(100),
	primary key(nome)
);
CREATE TABLE ALIM_REPLICA(
	ALIMENTO INTEGER NOT NULL,
	ANIMAL INTEGER NOT NULL,
	QUANT NUMERIC(12, 3),
	PRIMARY KEY (ALIMENTO, ANIMAL),
	FOREIGN KEY (ALIMENTO) REFERENCES alimento(id_alimento),
	FOREIGN KEY (ANIMAL) REFERENCES animal(id_animal)
);
